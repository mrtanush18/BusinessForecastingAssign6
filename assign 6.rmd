---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r}
# Set a CRAN mirror
options(repos = c(CRAN = "https://cran.r-project.org"))

install.packages("pacman")
#install.packages("readr")
library(pacman)
pacman::p_load(pacman, dplyr, forecast, fpp, fpp2, readr)

data <- read.csv("C:/Users/tanus/Downloads/BF assign 6/flightVolume.csv")

head(data)

str(data)

#1. Create Timeseries

ts_data = ts(data$permanent, frequency = 12, start = c(1980,1))

plot(ts_data)

```
2. Verify how much history to include in your analysis.
Looking at the time series plot, trend change is significant at around 300, so it makes sense to focus more on data after that point. Keeping too much older data might obscure recent patterns if conditions have changed.

3. Hypothesize if the dataset has trend, seasonality, or both. 
The time series likely contains both a trend and some form of seasonality. The trend is a gradual increase over time, while the repeating oscillations, particularly after point 300, suggest possible seasonality or cyclical patterns. The variability (amplitude of oscillations) also seems to increase over time, which might point to non-constant seasonality

```{r}
# 4. Verify using Acf

acf(ts_data)

# Based on the ACF, it seems there is a seasonal pattern in the data. The regularity and magnitude of spikes suggest that the series might have repeating cycles.

```
5. Verify using decomposition
The decomposition analysis was performed using a multiplicative model, which broke the time series into three components:
Trend: A visible long-term movement, confirming the presence of a trend.
Seasonality: The repeating cyclical pattern, confirming that the data exhibits seasonal behavior.
Residual (Noise): Random fluctuations that are not explained by trend or seasonality.
```{r}

decomposed <- decompose(ts_data, type = "multiplicative")
autoplot(decomposed)

stl_decomp <- stl(ts_data,s.window ="periodic")
plot(stl_decomp)
attributes(stl_decomp)
